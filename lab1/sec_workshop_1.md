MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMMWWNXK0OkxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO000000000000000000000000000000000000KKKKKKKKXNWMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMWX0Okxdlc:;;;;;;,,;;;;;;;;;;;;;,,;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::::::;;::::::::::cokKWMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMNOl:;;;;;;;,,;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;,;;;;;;;;;;,;;;;;;;;;;;;;;;;;;;;,,;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;,;;;;;l0WMMMMMMMMMMM
MMMMMMMMMMMMMMMWXx:;;,,;;;;;;;,,;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;cOWMMMMMMMMMMM
MMMMMMMMMMMMMMW0o;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;,;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;,;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;,,;;;;;;c0WMMMMMMMMMMM
MMMMMMMMMMMMMNOc;,;;;;;;;;,;;;;;;,;;,;;;;;;;;;,,;;;;;;;;;;;;clccccc::;,;,,;,;;;;;;;;;;;:;;;;;;;;;;;;,,;;;;;;;;;;;,,;;;;clooll:;;;;;;;;;okOOOxc;;,;;,;;;;;;;;;:clooolcc:;;;;;;;;,;;,,;;;;;;c0WMMMMMMMMMMM
MMMMMMMMMMMMNx:;;;;;;;;;;;,;;;;coddol:;,;;;;;;:loool:;;;;;;l0XNNXXXX0d:,;;,;;;;;:oxkOO0K0OOkxdl;;;;coooooooooollll:;,;:kNNWNXd;;;;;;;;:kNWMWXo;;;;,;;;,;cdxO0KXNWWNNNX0d:;;;;;;;,;;;;;;,;;c0WMMMMMMMMMMM
MMMMMMMMMMMWKl;;;;;;;;;;,,;;;;;xNWWWNkc;;;;;;l0NWWWKo;;;;;:OWMMMMMMMWXd;;;;;,;;o0NWMMMMMMMMMWNx;;;;xXNWWWWWWWWNNNXd;,;cOWMMMNx;;;;;;,;c0WMMMXo;;;,;;;;;lKWWMMMMMMMMMMMWN0o:;;;,;;;;;;;;,,;c0WMMMMMMMMMMM
MMMMMMMMMMMWKl,;;;;;;;;;;;;;;;:kWMMMMWKo:,;;oKWMMMWKo;;;;;oXMMMWXXWMMWKo;;;;,:dXWMMMMWNNNWWMWKl;;;;xNWMMMMMMMMMWWNx;;;:OWMMMNx;,;;;,;;lKWMMMXo;;;;,;;;:kNMMMMWKkkOO0KXNWWNOo:;,;;;;;;;;,,;c0WMMMMMMMMMMM
MMMMMMMMMMMWKl;;;;;;;;;;;;;;,;:OWMMMMMMNkc:xXWMMMMWKo,;;,:kWMMWKooKWMMW0c;;,;oKWMMMWKkoclodkkd:;;;;xNWMMMMXkxxxxddc;;;:OWMMMNx;,;;,,;;l0WMMMXo;,;;;;;;lKWMMWKxc;;;;;:clkNWWXd;;;;;;;;;;;;,c0WMMMMMMMMMMM
MMMMMMMMMMMWKl;;;;;;;;;,,;;;,;cOWMMMMMMMWKKNMMMMMMMKo,;;;lKWMMWOclKWMMMXd;;,:OWMMMW0l;;;;;,;;;;;;;;xNWMMMMXxddddo:;,,;cOWMMMNx;;;;;,;;c0WMMMXo;,;;;;;;xNMWKxc;,,;;;;;,;xNMMNd;;;;;;,;;;;;;c0WMMMMMMMMMMM
MMMMMMMMMMMW0l,;;;;;;;;;;;;;,,c0WMMMMMMMMMMMMMMMMMMKo;;;;dNMMMW0odXWMMMWk:,,cOWMMMWk:;;cddddolc;;;;kNWMMMMMWWWWWKo;;,;cOWMMMNx:;,;;;;,cOWMMMXo;,;;;;;:kWW0o:;;;;,;;;;;:kWMMXo;;;;,,,;;;;;;l0WMMMMMMMMMMM
MMMMMMMMMMMWKl,;;;;;;;;;;;;,;,c0WMMMMMMMMMMMMMMMMMMKl;;;:kWMMMWNKXNWMMMWKl;,cOWMMMNx;;;oKWWWWNk:;;;kNWMMMMMWWWWWKo;;;,cOWMMMNx:;,;;;,,cOWMMWXo;,;;;;,;dXWNXK0Od:;;;;;:dKWMWKl;;;,;,;;;;;;;l0WMMMMMMMMMMM
MMMMMMMMMMMW0l;;;;;;;;;;;;;,;,lKWMMMMWXNWMWNKNMMMMWKl;;;l0WMMMXxllkNMMMMXd;;:kWMMMW0o;;:xNMMMWOc;;:kNWMMMWKxddool:;;,,cOWMMMNx:;;;;;,,:OWMMWXxccccc::;:kNMMMMWXd;;;:dKNMMMW0c;;,;;;;;;;;;;l0WMMMMMMMMMMM
MMMMMMMMMMMW0c,;;;;;;;;;;;;;;;lKWMMMMXdlxkxll0WMMMWKl;;;dXMMMW0c;;oXMMMMWk:;;xWMMMMWXOdxKWMMMWO:,;:kNWMMMMXxddooll:;;,cOWMMMWKxdddxxdc:kWMMMWNXXXXXKx:;oKMMMMMW0lcd0NMMMMMWOc;;;;;,;;;;;;,l0WMMMMMMMMMMM
MMMMMMMMMMMW0c,;;;;;;;;;;;;;,,l0WMMMMXo;;;;,cOWMMMMKl,;:kNMMMWk:;;c0WMMMW0c,;l0WMMMMMWWWMMMMMNx:,,:kNWMMMMMWWWWWNXd;;;cOWMMMMMWWWWWWXd:kNMMMMMMMMMMWOc,:kNMMMMMWKKWMMMMMMN0o;;;;;;;;;;;;;,l0WMMMMMMMMMMM
MMMMMMMMMMMW0c,;;;;;;;;;;;;;;;cOWMMMMKl;;;;,:kWMMMWKl;;c0WMMWNx;,;:kWMMMWXo;;;cxXWMMMMMMMMMMWKl;,;:kNWMMMMMMMMMMWNd;;;cOWWMMMMMMMMMWXd:d0KXXXNNNNWWNOc,;cxO0KXNWWWMMMWWXOd:;,;;;;;;;;;;;;,l0WMMMMMMMMMMM
MMMMMMMMMMMW0c,;;;;;;;;;;;;;;;:kNWWWN0l;;;;;;xXXK00xc;;:oxxxxdc;,;;lO0KKK0d;,;;;lxkOOO00KK0Oko:;;;;okOO000O0000OOkl;;;:dkOOOOOOOOOOOkl;;::ccccllllooc;;,,;;::clodxkO00xl;;,,;;;;,;;;;;,;;;dXMMMMMMMMMMMM
MMMMMMMMMMMW0c;,,;;;;;;;,;;,;;;clooool:,;;;;;:cc::;;;;;,;;;;,;;,;;;;;::::c:;;,;;;;;;;;;::::;;;,;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;,,;;,,,;;;;;;;;;;;;;,;;;;;;;;;;;;;;;:lONWMMMMMMMMMMMM
MMMMMMMMMMMWKo;;,;;;;;;;;,;;,;,;;;;;;;;,;;;;;;;;;;;;;,;;;;;;;;;;;;;;;;;;;,,;,;;;;,,;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;,;;;;;;;;;;;;;,;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;,;;:oONWMMMMMMMMMMMMMM
MMMMMMMMMMMMWX0xl:;;,;;,;;,;;;;,;;;;;;;;,,;;;;;;,;;;;;;;,,;;;;;;;;;;;;;;,;;;;;;;;;;;;;;;;;,;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;,,,;;;;,;;;;;;,;;;,;;,;;,;;;;;;;;;;;;:oONWMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMWNKkxdoolllccccc:::::::;;;;;;;;;;;;;;;;;;,;;;;;;;;,;;;;;,;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:;;::;:::::::::::::coONWMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMWWWWNNNNNXXXXXKKKKK0000OOOOOkkkkkxxxxxxxxxxxxxxxxxxxxxxxxxxxxkkkkkkkkkkkkkkkkkkkkkOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOO0000000000000000000000K00KKKKKKKKKKKKKKKXNWMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
``` 
                                                                                          __            .__
                                 ______  ____    ____           __  _  __  ____  _______ |  | __  ______|  |__    ____  ______ 
                                /  ___/_/ __ \ _/ ___\   ______ \ \/ \/ / /  _ \ \_  __ \|  |/ / /  ___/|  |  \  /  _ \ \____ \ 
                                \___ \ \  ___/ \  \___  /_____/  \     / (  <_> ) |  | \/|    <  \___ \ |   Y  \(  <_> )|  |_> > 
                               /____  > \___  > \___  >           \/\_/   \____/  |__|   |__|_ \/____  >|___|  / \____/ |   __/
                                    \/      \/      \/                                        \/     \/      \/         |__|

```
---

# Bakgrund

Hur kommer det sej att vi ska göra det här då?


---

# Bakgrund

## Motivering
- Mer cloud -> mer ops 

- Säkert från start

- Kul sätt att bli bättre utvecklare (learning by breaking stuff)

---
# Bakgrund

## Långsiktiga mål

- Utbilda oss själva och varandra

- Kunna erbjuda säkerhetstjänster till kund (pentesting, statisk analys etc)


---
# Bakgrund

## Really?
- Och det är svinkul att hacka saker!

---


# Säkerhetsworkshop 19/10-22

Dagens tema:

 ```
                    ##        .            
   |          ## ## ##       ==            
   |       ## ## ## ##      ===            
   O   /""""""""""""""""\___/ ===        
  ~~~ {~~ ~~~~ ~~~ ~~~~ ~~ ~ /  ===- ~~~   
   |   \______ o          __/            
   0     \    \        __/             
 '.J      \____\______/                
 
          |          |
       __ |  __   __ | _  __   _
      /  \| /  \ /   |/  / _\ | 
      \__/| \__/ \__ |\_ \__  |
```
                                                  

Närmare bestämt:
### docker host attacker

- Maskinen som kör dina docker containers daemonen som tar hand om dem

- Ett vanligt förekommande problem, med t.ex felkonfigurerade docker sockets och management verktyg

### docker registry attacker
- Ett docker registry är som ett repository till vilket docker images laddas upp
- Egen-hostade registries är en känd attack vector


## Mer docker

- Vi kommer inte att ha en lång genomgång av vad docker är, men det är ett verktyg för paketera mjukvara för utveckling, testning och även deployment

- För den som vill göra en liten refresher så hänvisar vi till an3lls eminenta intro till docker lab: https://github.com/an3ll/docker-introduction-lba

- Det finns dessutom en labb för den som vill fräscha upp sina docker kunskaper
---

# Säkerhetsworkshop 19/10-22

## Upplägg
Vi kommer att använda onlineresursen attackdefense.com som har en hel del community-övningar (som är gratis...)

Kräver tyvärr att ett konto skapas, men man kan med fördel använda en temporär mejl (exempelvis duckduckgo.com/email)

Fokus för dagens lab kommer som sagt att vara olika typer av attacker mot docker hosten och docker registry


## CTF
Övningarna är generellt på formatet CTF (capture the flag) och går ut på att hitta en fil med en flagga som finns gömd någonstans i de VM:ar som ingår i övningen

Sen finns en flik för varje övning där man klistrar in sin flagga för att se att man hittat rätt, då är övningen avklarad!

Men detta finns väldigt bra beskrivet i instruktionerna till varje övning.


## Resurser
Varje uppgift har en steg-för-steg guide om man kör fast eller känner sej vilsen, men försök att inte titta på den om ni inte behöver så blir det roligare!

Jag och Björn kommer att gå runt och hjälpa till om det behövs, men vi är som sagt inga experter, utan vi gör detta tillsamman!

---

#  Docker host och docker registry attacker

Nog pratat, happy hacking!

## Docker basics:
https://attackdefense.com/challengedetails?cid=1342

## Misconfigured docker socket
https://attackdefense.com/challengedetails?cid=1194

## Mounted docker socket
https://attackdefense.com/challengedetails?cid=1195

## Insecure docker registry:
https://attackdefense.com/challengedetails?cid=1025

---

# Överkurs
För er überh4xx0rs som blir klara på fem minuter med ovanstående har vi även plockat fram denna:
https://notsosecure.com/vulnerable-docker-vm

Här krävs dock lite mer förkunskaper samt en fungerande virtualbox-setup på din lokala maskin.
Det finns två "lägen", easy mode och hard mode :-)


 
